TOPSRC = @top_srcdir@

MODULE = rc

C_SRCS = sysres.c

LANGUAGES = En Es De No Fr Fi Da

all: $(MODULE).o

@MAKE_RULES@

y.tab.c y.tab.h: parser.y
	$(YACC) -d -t parser.y

lex.yy.c: parser.l
	$(LEX) -8 -I parser.l

winerc: lex.yy.o winerc.o y.tab.o
	$(CC) $(ALLCFLAGS) lex.yy.o winerc.o y.tab.o -o winerc $(LEXLIB)

sysres.rct: sysres.rc $(LANGUAGES:%=sysres_%.rc)
	echo "#include \"windows.h\"" >sysres.rct
	echo WINDOWS_H_ENDS_HERE >>sysres.rct
	cat sysres.rc >>sysres.rct

sysres.c sysres.h: sysres.rct winerc
	$(CC) $(ALLCFLAGS) -E -x c -P sysres.rct | sed -e '1,/^WINDOWS_H_ENDS_HERE/d' | ./winerc -o sysres -v -p sysres

clean::
	$(RM) lex.yy.c sysres.rct winerc y.tab.c y.tab.h sysres.c sysres.h

langclean::
	$(RM) sysres.c sysres.h sysres.o

y.tab.o: y.tab.c y.tab.h parser.h
lex.yy.o: lex.yy.c y.tab.h parser.h
winerc.o: $(TOPSRC)/include/windows.h $(TOPSRC)/include/neexe.h parser.h y.tab.h

### Dependencies:
