DEFS      = @DLLFLAGS@ -D__WINESRC__ -DNO_LIBWINE_PORT
TOPSRCDIR = @top_srcdir@
TOPOBJDIR = ../..
SRCDIR    = @srcdir@
VPATH     = @srcdir@
LIBEXT    = @LIBEXT@
SOVERSION = 1
SONAME    = libwine_unicode.so.$(SOVERSION)
MODULE    = libwine_unicode.$(LIBEXT)

CODEPAGES = \
	037 \
	042 \
	424 \
	437 \
	500 \
	737 \
	775 \
	850 \
	852 \
	855 \
	856 \
	857 \
	860 \
	861 \
	862 \
	863 \
	864 \
	865 \
	866 \
	869 \
	874 \
	875 \
	878 \
	932 \
	936 \
	949 \
	950 \
	1006 \
	1026 \
	1250 \
	1251 \
	1252 \
	1253 \
	1254 \
	1255 \
	1256 \
	1257 \
	1258 \
	10000 \
	10006 \
	10007 \
	10029 \
	10079 \
	10081 \
	20866 \
	20932 \
	28591 \
	28592 \
	28593 \
	28594 \
	28595 \
	28596 \
	28597 \
	28598 \
	28599 \
	28600 \
	28603 \
	28604 \
	28605 \
	28606

C_SRCS = \
	casemap.c \
	compose.c \
	cptable.c \
	mbtowc.c \
	string.c \
	utf8.c \
	wctomb.c \
	wctype.c \
	$(CODEPAGES:%=c_%.c)

all: $(MODULE) $(MODULE:.dll=.a)

@MAKE_RULES@

libwine_unicode.so.$(SOVERSION): $(OBJS) Makefile.in
	$(LDSHARED) $(OBJS) -o $@

libwine_unicode.so: libwine_unicode.so.$(SOVERSION)
	$(RM) $@ && $(LN_S) libwine_unicode.so.$(SOVERSION) $@

libwine_unicode.a: wine_unicode.def
	$(DLLTOOL) -l $@ -d $(SRCDIR)/wine_unicode.def

libwine_unicode.dll: $(OBJS) wine_unicode.def Makefile.in
	$(DLLWRAP) --def $(SRCDIR)/wine_unicode.def -o $@ $(OBJS)

.PHONY: install-lib-so install-lib-dll install-dev-so install-dev-dll

install-lib-so: libwine_unicode.so.$(SOVERSION) dummy
	$(MKINSTALLDIRS) $(libdir)
	$(INSTALL_PROGRAM) libwine_unicode.so.$(SOVERSION) $(libdir)/libwine_unicode.so.$(SOVERSION)

install-lib-dll: libwine_unicode.dll dummy
	$(MKINSTALLDIRS) $(libdir)
	$(INSTALL_DATA) libwine_unicode.dll $(libdir)/libwine_unicode.dll

install-dev-so: dummy
	$(MKINSTALLDIRS) $(libdir)
	cd $(libdir) && $(RM) libwine_unicode.so && $(LN_S) libwine_unicode.so.$(SOVERSION) libwine_unicode.so

install-dev-dll: libwine_unicode.a dummy
	$(MKINSTALLDIRS) $(libdir)
	$(INSTALL_DATA) libwine_unicode.a $(libdir)/libwine_unicode.a

install install-lib:: $(LIBEXT:%=install-lib-%)
install install-dev:: $(LIBEXT:%=install-dev-%)

uninstall::
	$(RM) $(libdir)/libwine_unicode.a $(libdir)/libwine_unicode.dll $(libdir)/libwine_unicode.so $(libdir)/libwine_unicode.so.$(SOVERSION)

clean::
	$(RM) libwine_unicode.so.$(SOVERSION) libwine_unicode.dll

### Dependencies:
