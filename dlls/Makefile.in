TOPSRCDIR = @top_srcdir@
TOPOBJDIR = ..
SRCDIR    = @srcdir@
VPATH     = @srcdir@

INSTALLDIRS = $(DESTDIR)$(dlldir)

DLLSUBDIRS     = @ALL_DLL_DIRS@
TESTSUBDIRS    = @ALL_TEST_DIRS@
SUBDIRS        = $(DLLSUBDIRS) $(TESTSUBDIRS)
BUILDSUBDIRS   = $(DLLSUBDIRS) $(TESTSUBDIRS)
INSTALLSUBDIRS = $(DLLSUBDIRS)
DOCSUBDIRS     = $(DLLSUBDIRS)

@MAKE_RULES@

# Main target

all: $(BUILDSUBDIRS)

# Import libraries

IMPORT_LIBS = @ALL_IMPORT_LIBS@

$(TESTSUBDIRS:%=%/__crosstest__): $(IMPORT_LIBS:.def=.cross.a)

implib: $(IMPORT_LIBS)

testsubdirs: $(TESTSUBDIRS)

.PHONY: implib testsubdirs

$(BUILDSUBDIRS): $(IMPORT_LIBS)
$(INSTALLSUBDIRS:%=%/__install__) $(INSTALLSUBDIRS:%=%/__install-lib__): $(IMPORT_LIBS)

@ALL_IMPORTLIB_RULES@

# Misc rules

uninstall::
	-rmdir $(DESTDIR)$(fakedlldir) $(DESTDIR)$(dlldir)
