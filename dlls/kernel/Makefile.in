EXTRADEFS = -D_KERNEL32_
TOPSRCDIR = @top_srcdir@
TOPOBJDIR = ../..
SRCDIR    = @srcdir@
VPATH     = @srcdir@
MODULE    = kernel32.dll
IMPORTS   = ntdll
ALTNAMES  = krnl386.exe comm.dll stress.dll system.dll toolhelp.dll windebug.dll win87em.dll wprocs.dll
LDIMPORTS = ntdll.dll
EXTRALIBS = $(LIBUNICODE)
DLLMAIN   = MAIN_KernelInit

SPEC_SRCS16 = \
	comm.spec \
	krnl386.exe.spec \
	stress.spec \
	system.spec \
	toolhelp.spec \
	win87em.spec \
	windebug.spec \
	wprocs.spec

C_SRCS = \
	$(TOPOBJDIR)/ole/ole2nls.c \
	change.c \
	comm.c \
	computername.c \
	console.c \
	debugger.c \
	editline.c \
	format_msg.c \
	kernel_main.c \
	lcformat.c \
	locale.c \
	stress.c \
	string.c \
	sync.c \
	thunk.c \
	time.c \
	toolhelp.c \
	utthunk.c \
	win87em.c \
	windebug.c \
	wowthunk.c

C_SRCS16 = \
	registry16.c

RC_SRCS = kernel.rc

RC_SRCS16 = \
	version16.rc

MC_SRCS = \
	messages/winerr_enu.mc

SUBDIRS      = tests
EXTRASUBDIRS = messages nls $(TOPOBJDIR)/ole

@MAKE_DLL_RULES@

kernel.res: $(MC_SRCS:.mc=.mc.rc)

# Special rules for 16-bit resource and spec files

krnl386.exe.spec.c: krnl386.exe.spec version16.res
	$(LDPATH) $(WINEBUILD) $(DEFS) -o $@ --dll-name kernel --main-module $(MODULE) --res version16.res --spec $(SRCDIR)/krnl386.exe.spec

version16.res: version16.rc
	$(LDPATH) $(WRC) $(WRCFLAGS) -o $@ -O res16 $(SRCDIR)/version16.rc

### Dependencies:
