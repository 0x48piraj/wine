DEFS      = -DWINELIB
TOPSRCDIR = @top_srcdir@
TOPOBJDIR = ../..
SRCDIR    = @srcdir@
VPATH     = @srcdir@
MODULE    = none
PROGRAMS  = progman
ALL_LIBS  = $(WINELIB) $(X_LIBS) $(XPM_LIB) $(XLIB) $(LIBS)
RCFLAGS   = -w32 -h

LANGUAGES   = En Da De Fr Fi Ko Hu It Va Sw
LICENSELANG = En

MOSTSRCS = \
	dialog.c \
	group.c \
	grpfile.c \
	license.c \
	main.c \
	program.c

# Some strings need addresses >= 0x10000
STRINGSRCS = \
	string.c \
	$(LICENSELANG:%=License_%.c)

RC_SRCS = \
	accel.rc \
	$(LANGUAGES:%=%.rc)

C_SRCS = $(MOSTSRCS) $(STRINGSRCS)

MOSTOBJS = $(MOSTSRCS:.c=.o)
STRINGOBJS = $(STRINGSRCS:.c=.o) $(RC_SRCS:.rc=.o)

all: check_winerc $(PROGRAMS)

depend:: $(RC_SRCS:.rc=.h)

@MAKE_RULES@

# Rules for using old resource compiler
.rc.c:
	echo "#include \"windows.h\"" >$*-tmp.c
	echo WINDOWS_H_ENDS_HERE >>$*-tmp.c
	cat $< >>$*-tmp.c
	$(CPP) $(DEFS) $(OPTIONS) $(DIVINCL) -DRC_INVOKED -P $*-tmp.c | sed -e '1,/^WINDOWS_H_ENDS_HERE/d' | $(WINERC) $(RCFLAGS) -c -o $* -p $*
	$(RM) $*-tmp.c
.rc.h:
	echo "#include \"windows.h\"" >$*-tmp.c
	echo WINDOWS_H_ENDS_HERE >>$*-tmp.c
	cat $< >>$*-tmp.c
	$(CPP) $(DEFS) $(OPTIONS) $(DIVINCL) -DRC_INVOKED -P $*-tmp.c | sed -e '1,/^WINDOWS_H_ENDS_HERE/d' | $(WINERC) $(RCFLAGS) -c -o $* -p $*
	$(RM) $*-tmp.c
clean::
	$(RM) $(RC_SRCS:.rc=.c)


progman: $(MOSTOBJS) $(STRINGOBJS)
	$(CC) -o progman $(MOSTOBJS) $(LDOPTIONS) $(ALL_LIBS) $(STRINGOBJS)

install: dummy
	$(INSTALL_PROGRAM) progman $(bindir)/progman

$(RC_SRCS:.rc=.c) $(RC_SRCS:.rc=.h): $(WINERC)

dummy:

### Dependencies:
